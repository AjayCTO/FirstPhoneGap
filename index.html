<!DOCTYPE html>
<html>
 <head>
 	<meta charset="UTF-8" />
 	<meta name="viewport" content="width=device-width, initial-scale=1">
 	<title>Title</title>
 	<link rel="stylesheet" href="css/jquery.mobile-1.3.1.min.css" type="text/css">
 	<script type="text/javascript" src="js/jquery.js"></script>
 	<script type="text/javascript" src="js/app.js"></script>
 	<script type="text/javascript" src="js/jquery.mobile-1.3.1.min.js"></script>
 	<script type="text/javascript" src="cordova.js"></script>
 	<link rel="stylesheet" href="css/app.css" type="text/css">
	<script type="text/javascript" charset="utf-8">

var pictureSource;   
var destinationType; 

document.addEventListener("deviceready",onDeviceReady,false);

function onDeviceReady() 
{
    pictureSource=navigator.camera.PictureSourceType;
    destinationType=navigator.camera.DestinationType;
}


function onPhotoURISuccess(imageURI) 
{
    console.log(imageURI);
   // var largeImage = document.getElementById('largeImage');
  //  largeImage.style.display = 'block';
   // largeImage.src = imageURI;
	var img = $('<img />');
	img.attr('src', imageURI);

	// Append new img to our photos div
	img.appendTo('#photos');
}

function onPhotoDataSuccess(imageURI) 
{ 
    var imgProfile = document.getElementById('clicked');
    imgProfile.src = imageURI;
    if(sessionStorage.isprofileimage==1)
    {
        getLocation();
    }
    movePic(imageURI);
}

function onFail(message) 
{
    alert('Failed because: ' + message);
}

function movePic(file)
{ 
    window.resolveLocalFileSystemURI(file, resolveOnSuccess, resOnError); 
} 

function resolveOnSuccess(entry)
{ 
    var d = new Date();
    var n = d.getTime();
    var newFileName = n + ".jpg";
    var myFolderApp = "MyAppFolder";
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSys) 
    {      
        fileSys.root.getDirectory( myFolderApp,
                {create:true, exclusive: false},
                function(directory) 
                {
                    entry.moveTo(directory, newFileName,  successMove, resOnError);
                },
        resOnError);
    },
    resOnError);
}

function successMove(entry) 
{
    sessionStorage.setItem('imagepath', entry.fullPath);
}

function resOnError(error) 
{
    alert(error.code);
}

function capturePhotoEdit() 
{
    navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true,
    destinationType: destinationType.DATA_URL });
}

function getPhoto(source) 
{
    navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50, 
    destinationType: destinationType.FILE_URI,
    sourceType: source });
}

function onFail(message) 
{
    alert('Failed because: ' + message);
}

</script>
 </head>
 <body>
 	<div data-role="page" id="login">
 		<div data-role="content">
 			<br><br><div data-role="collapsible" data-theme="b" data-content-theme="d" data-collapsed="false">
			    <h4>Boilerplate Login Panel</h4>
			    <div data-role="fieldcontain">
			    <label for="textinput-fc">Username:</label>
			    <input type="text" name="textinput-fc" id="textinput-fc" placeholder="Email Address / Username" value="">
			</div>
			<div data-role="fieldcontain">
			    <label for="textinput-fc">Password:</label>
			    <input type="text" name="textinput-fc" id="textinput-fc" placeholder="Password" value="">
			</div>
 			<a href="#home" data-role="button" data-transition="none">Click to Login</a>
			</div>
 		</div>
 	</div>

 	<div data-role="page" id="home" data-add-back-btn="true">
 		<div data-role="header">
 			<h1>Header Text</h1>
 		</div>
 		<div data-role="content">
 			<button onclick="capturePhotoEdit();">Capture Photo</button>
			<button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">From Gallery!!</button>
 		</div>
		<div id="photos">
		</div>
		<div >
		<img src="#" id="clicked" class="thumbnail" />
		</div>
 		<div data-role="footer" data-position="fixed">		
 			<h1>&copy; Footer Text</h1>
 		</div>

 	</div>
 </body>
</html>